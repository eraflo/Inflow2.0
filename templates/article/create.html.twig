{% extends 'base.html.twig' %}

{% block title %}Inflow{% endblock %}

{% block body %}
    <p>Article</p>
    {{ form_start(articleForm) }}
        {{ form_errors(articleForm) }}
        {# form_widget(articleForm.concerns) #}
        {# form_row(articleForm.concerns.vars.prototype) #}
        {# the data-index attribute is required for the JavaScript code below #}
<ul class="tags"
    data-index="{{ articleForm.concerns|length > 0 ? articleForm.concerns|last.vars.name + 1 : 0 }}"
    data-prototype="{{ form_widget(articleForm.concerns.vars.prototype)|e('html_attr') }}"
></ul>
<button type="button" class="add_item_link" data-collection-holder-class="tags">Add a tag</button>
    {{ form_end(articleForm) }}
<script>
const addFormToCollection = (e) => {
  const collectionHolder = document.querySelector('.' + e.currentTarget.dataset.collectionHolderClass);

  const item = document.createElement('li');

  item.innerHTML = collectionHolder
    .dataset
    .prototype
    .replace(
      /__name__/g,
      collectionHolder.dataset.index
    );

  collectionHolder.appendChild(item);

  collectionHolder.dataset.index++;
};

document
  .querySelectorAll('.add_item_link')
  .forEach(btn => {
      btn.addEventListener("click", addFormToCollection)
  });
</script>

{% endblock %}
